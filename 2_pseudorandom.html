<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>4&nbsp; Números Pseudoaleatórios – Curso de Programação Estatística</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./3_discrete_inversion.html" rel="next">
<link href="./1_intro.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Curso de Programação Estatística</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/thiagorr162/prog-estat"> <i class="bi bi-github" role="img" aria-label="GitHub">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./2_pseudorandom.html"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Números Pseudoaleatórios</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Curso de Programação Estatística</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./0_py.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Breve introdução ao Python</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./0_R.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Breve Introdução ao R</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1_intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Geração de Números Aleatórios e Aplicação em Estatística</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2_pseudorandom.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Números Pseudoaleatórios</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./3_discrete_inversion.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Técnica da Inversão para Variáveis Discretas</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./4_continuous_inversion.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Técnica da Inversão para Variáveis Contínuas</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./5_discrete_rejection.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Método da Rejeição para Variáveis Discretas</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./6_continuous_rejection.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Método da Rejeição para Variáveis Contínuas</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./7_transf.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Transformação e Misturas</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./8_box_muller.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Método de Box-Muller</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./9_monte_carlo.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Método de Monte Carlo</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10_var_red.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Técnicas de Redução de Variância</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./11_import.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Amostragem por Importância</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul class="collapse">
  <li><a href="#o-que-é-um-número-pseudoaleatório" id="toc-o-que-é-um-número-pseudoaleatório" class="nav-link active" data-scroll-target="#o-que-é-um-número-pseudoaleatório"><span class="header-section-number">4.1</span> O que é um número pseudoaleatório?</a></li>
  <li><a href="#geração-de-números-pseudoaleatórios-com-o-gerador-linear-congruente-lcg" id="toc-geração-de-números-pseudoaleatórios-com-o-gerador-linear-congruente-lcg" class="nav-link" data-scroll-target="#geração-de-números-pseudoaleatórios-com-o-gerador-linear-congruente-lcg"><span class="header-section-number">4.2</span> Geração de Números Pseudoaleatórios com o Gerador Linear Congruente (LCG)</a></li>
  <li><a href="#por-que-o-gerador-linear-congruente-funciona" id="toc-por-que-o-gerador-linear-congruente-funciona" class="nav-link" data-scroll-target="#por-que-o-gerador-linear-congruente-funciona"><span class="header-section-number">4.3</span> Por que o Gerador Linear Congruente Funciona?</a></li>
  <li><a href="#gerando-números-uniformes-com-uma-moeda" id="toc-gerando-números-uniformes-com-uma-moeda" class="nav-link" data-scroll-target="#gerando-números-uniformes-com-uma-moeda"><span class="header-section-number">4.4</span> Gerando números uniformes com uma moeda</a></li>
  <li><a href="#método-de-monte-carlo" id="toc-método-de-monte-carlo" class="nav-link" data-scroll-target="#método-de-monte-carlo"><span class="header-section-number">5</span> Método de Monte Carlo</a>
  <ul class="collapse">
  <li><a href="#exemplo-1-estimativa-de-uma-integral" id="toc-exemplo-1-estimativa-de-uma-integral" class="nav-link" data-scroll-target="#exemplo-1-estimativa-de-uma-integral"><span class="header-section-number">5.1</span> Exemplo 1: Estimativa de uma Integral</a></li>
  <li><a href="#exemplo-2-aproximando-uma-probabilidade" id="toc-exemplo-2-aproximando-uma-probabilidade" class="nav-link" data-scroll-target="#exemplo-2-aproximando-uma-probabilidade"><span class="header-section-number">5.2</span> Exemplo 2: Aproximando uma Probabilidade</a></li>
  <li><a href="#exemplo-3-aproximando-o-valor-de-pi" id="toc-exemplo-3-aproximando-o-valor-de-pi" class="nav-link" data-scroll-target="#exemplo-3-aproximando-o-valor-de-pi"><span class="header-section-number">5.3</span> Exemplo 3: Aproximando o valor de <span class="math inline">\(\pi\)</span></a></li>
  <li><a href="#intervalos-de-confiança-para-estimativas-de-monte-carlo" id="toc-intervalos-de-confiança-para-estimativas-de-monte-carlo" class="nav-link" data-scroll-target="#intervalos-de-confiança-para-estimativas-de-monte-carlo"><span class="header-section-number">5.4</span> Intervalos de Confiança para Estimativas de Monte Carlo</a></li>
  <li><a href="#exemplo-4-problema-das-figurinhas" id="toc-exemplo-4-problema-das-figurinhas" class="nav-link" data-scroll-target="#exemplo-4-problema-das-figurinhas"><span class="header-section-number">5.5</span> Exemplo 4: Problema das Figurinhas</a></li>
  <li><a href="#exercícios" id="toc-exercícios" class="nav-link" data-scroll-target="#exercícios"><span class="header-section-number">5.6</span> Exercícios</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Números Pseudoaleatórios</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>Números aleatórios têm muitas aplicações na computação, como em simulações, amostragem estatística, criptografia e jogos de azar. No entanto, os computadores, por serem sistemas determinísticos, não podem gerar números realmente aleatórios de forma autônoma. Em vez disso, utilizam algoritmos determinísticos que geram números que parecem aleatórios, e esses números são chamados de pseudoaleatórios.</p>
<section id="o-que-é-um-número-pseudoaleatório" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="o-que-é-um-número-pseudoaleatório"><span class="header-section-number">4.1</span> O que é um número pseudoaleatório?</h2>
<p>Um número pseudoaleatório é gerado a partir de uma fórmula matemática que, a partir de uma semente (um valor inicial), gera uma sequência de números que tem as propriedades desejadas de uma sequência aleatória. Essa sequência parece aleatória, mas se a mesma semente for usada, a sequência será a mesma.</p>
</section>
<section id="geração-de-números-pseudoaleatórios-com-o-gerador-linear-congruente-lcg" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="geração-de-números-pseudoaleatórios-com-o-gerador-linear-congruente-lcg"><span class="header-section-number">4.2</span> Geração de Números Pseudoaleatórios com o Gerador Linear Congruente (LCG)</h2>
<p><a href="https://en.wikipedia.org/wiki/Linear_congruential_generator">Link para o wikipedia</a></p>
<p>O <strong>Gerador Linear Congruente</strong> (LCG) é um dos métodos mais antigos e simples para gerar números pseudoaleatórios. Ele segue a fórmula:</p>
<p><span class="math display">\[
X_{n+1} = (a \cdot X_n + c) \mod m
\]</span></p>
<p>Onde: - <span class="math inline">\(X_n\)</span> é o número atual (ou a semente inicial), - <span class="math inline">\(a\)</span> é o multiplicador, - <span class="math inline">\(c\)</span> é o incremento, - <span class="math inline">\(m\)</span> é o módulo, ou seja, o intervalo dos números gerados.</p>
<p>A sequência gerada pelo LCG depende diretamente dos parâmetros <span class="math inline">\(a\)</span>, <span class="math inline">\(c\)</span>, <span class="math inline">\(m\)</span> e da semente inicial <span class="math inline">\(X_0\)</span>. Um conjunto mal escolhido de parâmetros pode resultar em uma sequência com um período curto, o que compromete a aleatoriedade da sequência.</p>
<section id="o-que-é-a-função-módulo" class="level3" data-number="4.2.1">
<h3 data-number="4.2.1" class="anchored" data-anchor-id="o-que-é-a-função-módulo"><span class="header-section-number">4.2.1</span> O que é a Função Módulo?</h3>
<p>A <strong>função módulo</strong> (também conhecida como operação de resto) retorna o <strong>resto da divisão</strong> de um número por outro. Em termos matemáticos, para dois números inteiros <span class="math inline">\(a\)</span> e <span class="math inline">\(b\)</span>, a operação módulo é representada como:</p>
<p><span class="math display">\[
r = a \mod b
\]</span></p>
<p>Onde: - <span class="math inline">\(a\)</span> é o dividendo, - <span class="math inline">\(b\)</span> é o divisor, - <span class="math inline">\(r\)</span> é o resto da divisão de <span class="math inline">\(a\)</span> por <span class="math inline">\(b\)</span>.</p>
<p>Por exemplo, se temos <span class="math inline">\(a = 17\)</span> e <span class="math inline">\(b = 5\)</span>, a divisão de 17 por 5 dá 3 com um resto de 2, então:</p>
<p><span class="math display">\[
17 \mod 5 = 2
\]</span></p>
<p>No contexto do <strong>Gerador Linear Congruente (LCG)</strong>, a função módulo é usada para garantir que os números gerados fiquem dentro de um intervalo específico, geralmente entre 0 e <span class="math inline">\(m-1\)</span>, onde <span class="math inline">\(m\)</span> é o módulo definido no algoritmo.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">Python</a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<div class="cell">
<details class="code-fold">
<summary>Mostrar código</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Exemplo de uso da função módulo em R</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Definindo os valores</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="dv">17</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculando o módulo de a por b</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>resto <span class="ot">&lt;-</span> a <span class="sc">%%</span> b</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Exibindo o resultado</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"O resultado de"</span>, a, <span class="st">"%%"</span>, b, <span class="st">"é:"</span>, resto, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>O resultado de 17 %% 3 é: 2 </code></pre>
</div>
</div>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<div class="cell">
<details class="code-fold">
<summary>Mostrar código</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Exemplo de uso da função módulo em Python</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Definindo os valores</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> <span class="dv">17</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>b <span class="op">=</span> <span class="dv">3</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculando o módulo de a por b</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>resto <span class="op">=</span> a <span class="op">%</span> b</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Exibindo o resultado</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"O resultado de </span><span class="sc">{</span>a<span class="sc">}</span><span class="ss"> % </span><span class="sc">{</span>b<span class="sc">}</span><span class="ss"> é: </span><span class="sc">{</span>resto<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>O resultado de 17 % 3 é: 2</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="por-que-o-gerador-linear-congruente-funciona" class="level2" data-number="4.3">
<h2 data-number="4.3" class="anchored" data-anchor-id="por-que-o-gerador-linear-congruente-funciona"><span class="header-section-number">4.3</span> Por que o Gerador Linear Congruente Funciona?</h2>
<p>O Gerador Linear Congruente (LCG) é um dos métodos mais simples e eficientes para gerar números pseudoaleatórios. Sua eficácia se baseia em um bom equilíbrio entre a escolha dos parâmetros (multiplicador <span class="math inline">\(a\)</span>, incremento <span class="math inline">\(c\)</span>, módulo <span class="math inline">\(m\)</span> e semente inicial <span class="math inline">\(X_0\)</span>) e as propriedades matemáticas que garantem uma sequência suficientemente “aleatória”. Para que o LCG funcione bem, os parâmetros precisam ser cuidadosamente selecionados para garantir que a sequência gerada tenha um período longo, seja bem distribuída e evite padrões repetitivos.</p>
<section id="a-fórmula-do-lcg" class="level3" data-number="4.3.1">
<h3 data-number="4.3.1" class="anchored" data-anchor-id="a-fórmula-do-lcg"><span class="header-section-number">4.3.1</span> A Fórmula do LCG</h3>
<p>A fórmula básica do LCG é:</p>
<p><span class="math display">\[
X_{n+1} = (a \cdot X_n + c) \mod m
\]</span></p>
<p>Onde: - <span class="math inline">\(X_n\)</span> é o número gerado na <span class="math inline">\(n\)</span>-ésima iteração, - <span class="math inline">\(a\)</span> é o multiplicador, - <span class="math inline">\(c\)</span> é o incremento, - <span class="math inline">\(m\)</span> é o módulo, - <span class="math inline">\(X_0\)</span> é a semente inicial.</p>
<p>O número gerado em cada iteração é o <strong>resto da divisão</strong> de <span class="math inline">\((a \cdot X_n + c)\)</span> por <span class="math inline">\(m\)</span>. Essa operação garante que os números fiquem dentro do intervalo <span class="math inline">\([0, m-1]\)</span>. A normalização posterior geralmente transforma esses números em valores no intervalo <span class="math inline">\([0, 1)\)</span>.</p>
</section>
<section id="o-papel-de-m" class="level3" data-number="4.3.2">
<h3 data-number="4.3.2" class="anchored" data-anchor-id="o-papel-de-m"><span class="header-section-number">4.3.2</span> O Papel de <span class="math inline">\(m\)</span></h3>
<p>O valor de <span class="math inline">\(m\)</span>, conhecido como módulo, define o intervalo no qual os números gerados estarão contidos. Em muitos casos, <span class="math inline">\(m\)</span> é escolhido como uma potência de 2 (por exemplo, <span class="math inline">\(m = 2^{32}\)</span> ou <span class="math inline">\(m = 2^{64}\)</span>) porque cálculos modulares com potências de 2 são mais rápidos em hardware.</p>
<p>A escolha de <span class="math inline">\(m\)</span> também influencia o <strong>período máximo</strong> da sequência. Se todos os parâmetros forem escolhidos corretamente, o LCG pode gerar uma sequência com o período máximo, que é <span class="math inline">\(m\)</span>. Isso significa que a sequência não repetirá nenhum número até que <span class="math inline">\(m\)</span> números tenham sido gerados.</p>
</section>
<section id="o-papel-de-a-c-e-a-condição-de-coprimos" class="level3" data-number="4.3.3">
<h3 data-number="4.3.3" class="anchored" data-anchor-id="o-papel-de-a-c-e-a-condição-de-coprimos"><span class="header-section-number">4.3.3</span> O Papel de <span class="math inline">\(a\)</span>, <span class="math inline">\(c\)</span> e a Condição de Coprimos</h3>
<p>Para garantir que o gerador tenha o período máximo (ou seja, <span class="math inline">\(m\)</span> números diferentes antes de repetir a sequência), a escolha dos parâmetros <span class="math inline">\(a\)</span> (multiplicador), <span class="math inline">\(c\)</span> (incremento) e <span class="math inline">\(m\)</span> (módulo) deve satisfazer as seguintes condições baseadas em <strong>teorias de números</strong>:</p>
<ol type="1">
<li><strong>O incremento <span class="math inline">\(c\)</span> deve ser coprimo com <span class="math inline">\(m\)</span></strong>:
<ul>
<li>Dois números são <strong>coprimos</strong> se o maior divisor comum deles for 1, ou seja, <span class="math inline">\(\text{gcd}(c, m) = 1\)</span>. Isso garante que, ao somar <span class="math inline">\(c\)</span>, todos os possíveis valores de <span class="math inline">\(X_n\)</span> possam ser atingidos antes de repetir a sequência.</li>
<li>Se <span class="math inline">\(c\)</span> não for coprimo com <span class="math inline">\(m\)</span>, a sequência gerada pode pular certos valores, resultando em um período mais curto do que o esperado.</li>
</ul></li>
<li><strong>O valor de <span class="math inline">\(a - 1\)</span> deve ser divisível por todos os fatores primos de <span class="math inline">\(m\)</span></strong>:
<ul>
<li>Se <span class="math inline">\(m\)</span> é uma potência de 2 (por exemplo, <span class="math inline">\(m = 2^k\)</span>), a escolha de <span class="math inline">\(a\)</span> deve ser tal que <span class="math inline">\((a - 1)\)</span> seja divisível por 2 para garantir que o período seja maximizado.</li>
</ul></li>
<li><strong>Se <span class="math inline">\(m\)</span> for divisível por 4, então <span class="math inline">\((a - 1)\)</span> também deve ser divisível por 4</strong>:
<ul>
<li>Isso é necessário para garantir que todos os resíduos modulares possíveis possam ser gerados, especialmente quando <span class="math inline">\(m\)</span> é uma potência de 2.</li>
</ul></li>
</ol>
</section>
<section id="exemplo-de-uma-escolha-correta-de-parâmetros" class="level3" data-number="4.3.4">
<h3 data-number="4.3.4" class="anchored" data-anchor-id="exemplo-de-uma-escolha-correta-de-parâmetros"><span class="header-section-number">4.3.4</span> Exemplo de uma Escolha Correta de Parâmetros</h3>
<p>Um exemplo clássico de um bom conjunto de parâmetros é:</p>
<ul>
<li><span class="math inline">\(m = 2^{32}\)</span> (módulo com 32 bits),</li>
<li><span class="math inline">\(a = 1664525\)</span> (multiplicador),</li>
<li><span class="math inline">\(c = 1013904223\)</span> (incremento),</li>
<li><span class="math inline">\(X_0 = 42\)</span> (semente inicial, que pode ser qualquer valor).</li>
</ul>
<p>Esses parâmetros foram escolhidos para garantir que o LCG tenha um longo período e uma boa distribuição dos números gerados. O módulo <span class="math inline">\(m = 2^{32}\)</span> é uma potência de 2, o que torna as operações modulares mais rápidas, e os valores de <span class="math inline">\(a\)</span> e <span class="math inline">\(c\)</span> satisfazem as condições matemáticas para maximizar o período.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false">Python</a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<div class="cell">
<details class="code-fold">
<summary>Mostrar código</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Importando o pacote necessário</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gmp)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Parâmetros do exemplo</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">^</span><span class="dv">32</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="dv">1664525</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>c <span class="ot">&lt;-</span> <span class="dv">1013904223</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Verificando as condições</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. O incremento c deve ser coprimo com m</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>coprimo_c_m <span class="ot">&lt;-</span> <span class="fu">gcd</span>(c, m) <span class="sc">==</span> <span class="dv">1</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. a - 1 deve ser divisível por todos os fatores primos de m</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>a_menos_1 <span class="ot">&lt;-</span> a <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(a_menos_1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1664524</code></pre>
</div>
<details class="code-fold">
<summary>Mostrar código</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Verificando se a - 1 é divisível por 2 (único fator primo de m = 2^32)</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>divisivel_por_2 <span class="ot">&lt;-</span> (a_menos_1 <span class="sc">%%</span> <span class="dv">2</span> <span class="sc">==</span> <span class="dv">0</span>)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Se m for divisível por 4, a - 1 também deve ser divisível por 4</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>divisivel_por_4 <span class="ot">&lt;-</span> (a_menos_1 <span class="sc">%%</span> <span class="dv">4</span> <span class="sc">==</span> <span class="dv">0</span>)</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="fu">list</span>(coprimo_c_m, divisivel_por_2, divisivel_por_4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
[1] TRUE

[[2]]
[1] TRUE

[[3]]
[1] TRUE</code></pre>
</div>
</div>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<div class="cell">
<details class="code-fold">
<summary>Mostrar código</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> math</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Parâmetros do exemplo</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>m <span class="op">=</span> <span class="dv">2</span><span class="op">**</span><span class="dv">32</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> <span class="dv">1664525</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>c <span class="op">=</span> <span class="dv">1013904223</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Verificando as condições</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. O incremento c deve ser coprimo com m</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>coprimo_c_m <span class="op">=</span> math.gcd(c, m) <span class="op">==</span> <span class="dv">1</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. a - 1 deve ser divisível por todos os fatores primos de m</span></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>a_menos_1 <span class="op">=</span> a <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(a_menos_1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>1664524</code></pre>
</div>
<details class="code-fold">
<summary>Mostrar código</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Verificando se a - 1 é divisível por 2 (único fator primo de m = 2^32)</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>divisivel_por_2 <span class="op">=</span> (a_menos_1 <span class="op">%</span> <span class="dv">2</span> <span class="op">==</span> <span class="dv">0</span>)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Se m for divisível por 4, a - 1 também deve ser divisível por 4</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>divisivel_por_4 <span class="op">=</span> (a_menos_1 <span class="op">%</span> <span class="dv">4</span> <span class="op">==</span> <span class="dv">0</span>)</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>coprimo_c_m, divisivel_por_2, divisivel_por_4</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>(True, True, True)</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="por-que-o-lcg-funciona-bem" class="level3" data-number="4.3.5">
<h3 data-number="4.3.5" class="anchored" data-anchor-id="por-que-o-lcg-funciona-bem"><span class="header-section-number">4.3.5</span> Por que o LCG Funciona Bem?</h3>
<p>O LCG funciona porque: - <strong>As operações modulares</strong> garantem que os números gerados estejam dentro de um intervalo fixo e possam cobrir todo o espaço de possíveis valores de maneira ordenada. - <strong>A escolha adequada dos parâmetros</strong> garante que a sequência tenha um longo período (o maior possível dado <span class="math inline">\(m\)</span>), evita padrões repetitivos e assegura que a sequência seja <strong>pseudoaleatória</strong> o suficiente para muitas aplicações, como simulações e métodos de Monte Carlo.</p>
<p>No entanto, o LCG pode não ser adequado para todas as aplicações, especialmente em criptografia, onde a previsibilidade é um problema. Para a maioria dos usos científicos e de simulação, ele ainda é uma escolha eficiente e simples.</p>
</section>
<section id="efeito-dos-parâmetros-no-gerador-linear-congruente-lcg" class="level3" data-number="4.3.6">
<h3 data-number="4.3.6" class="anchored" data-anchor-id="efeito-dos-parâmetros-no-gerador-linear-congruente-lcg"><span class="header-section-number">4.3.6</span> Efeito dos Parâmetros no Gerador Linear Congruente (LCG)</h3>
<p>Os parâmetros no Gerador Linear Congruente (LCG) têm um impacto significativo sobre a qualidade e as propriedades da sequência de números pseudoaleatórios gerados. Os parâmetros principais são:</p>
<ol type="1">
<li><strong>Multiplicador <span class="math inline">\(a\)</span></strong>:
<ul>
<li>Esse parâmetro é essencial para garantir que a sequência de números gerados tenha um bom período (o número de valores distintos antes de a sequência começar a se repetir). Se o valor de <span class="math inline">\(a\)</span> não for bem escolhido, o período da sequência pode ser curto e a qualidade dos números gerados diminui.</li>
<li>Bons valores de <span class="math inline">\(a\)</span> são cruciais para evitar padrões repetitivos ou ciclos curtos.</li>
</ul></li>
<li><strong>Incremento <span class="math inline">\(c\)</span></strong>:
<ul>
<li>O incremento <span class="math inline">\(c\)</span> adiciona um valor fixo à sequência e é um dos fatores que pode garantir que todos os valores no intervalo <span class="math inline">\([0, m)\)</span> sejam atingidos em algum momento, desde que os outros parâmetros também sejam bem escolhidos.</li>
<li>Quando <span class="math inline">\(c = 0\)</span>, o gerador é chamado de <strong>multiplicativo</strong>. Nessa forma, o LCG pode ter um comportamento menos uniforme.</li>
</ul></li>
<li><strong>Módulo <span class="math inline">\(m\)</span></strong>:
<ul>
<li>O módulo define o intervalo dos números gerados. Comumente, <span class="math inline">\(m\)</span> é escolhido como uma potência de 2 (por exemplo, <span class="math inline">\(m = 2^{32}\)</span>) para facilitar os cálculos modulares em hardware e software.</li>
<li>O valor de <span class="math inline">\(m\)</span> também determina o período máximo da sequência de números. Com um módulo de <span class="math inline">\(m\)</span>, o período máximo teórico que o LCG pode ter é <span class="math inline">\(m\)</span>, mas isso depende da escolha correta dos parâmetros <span class="math inline">\(a\)</span> e <span class="math inline">\(c\)</span>.</li>
</ul></li>
<li><strong>Semente <span class="math inline">\(X_0\)</span></strong>:
<ul>
<li>A semente é o valor inicial de <span class="math inline">\(X_0\)</span> usado pelo LCG para iniciar a sequência. Mudar a semente resultará em uma sequência diferente, mas com o mesmo período e comportamento determinado pelos outros parâmetros.</li>
<li>A semente garante que o algoritmo possa ser <strong>reproduzido</strong>. Se dois programas utilizarem a mesma semente com os mesmos parâmetros, ambos produzirão a mesma sequência de números.</li>
</ul></li>
</ol>
</section>
<section id="impacto-dos-parâmetros" class="level3" data-number="4.3.7">
<h3 data-number="4.3.7" class="anchored" data-anchor-id="impacto-dos-parâmetros"><span class="header-section-number">4.3.7</span> Impacto dos Parâmetros:</h3>
<ol type="1">
<li><strong>Período da Sequência</strong>:
<ul>
<li>O período é a quantidade de números gerados antes que a sequência comece a se repetir. Para obter o período máximo, os parâmetros <span class="math inline">\(a\)</span>, <span class="math inline">\(c\)</span>, <span class="math inline">\(m\)</span> e a semente <span class="math inline">\(X_0\)</span> precisam ser cuidadosamente escolhidos.</li>
<li>Se os parâmetros não forem bons, o gerador pode produzir uma sequência com um ciclo muito curto ou, pior, um conjunto pequeno de valores.</li>
</ul></li>
<li><strong>Distribuição dos Números</strong>:
<ul>
<li>Embora o LCG gere números no intervalo <span class="math inline">\([0, 1)\)</span>, o quão bem distribuídos esses números estão nesse intervalo depende dos parâmetros.</li>
<li>Parâmetros mal escolhidos podem causar uma distribuição não uniforme, onde certos intervalos terão mais números gerados que outros, levando a um comportamento indesejável.</li>
</ul></li>
<li><strong>Padrões Repetitivos</strong>:
<ul>
<li>Se os parâmetros forem mal escolhidos, podem surgir padrões repetitivos que comprometem a aleatoriedade dos números. Esses padrões tornam o LCG inadequado para algumas aplicações, como criptografia ou simulações que exigem alta qualidade de aleatoriedade.</li>
</ul></li>
</ol>
<p>Por essas razões, a escolha dos parâmetros <span class="math inline">\(a\)</span>, <span class="math inline">\(c\)</span>, <span class="math inline">\(m\)</span> e da semente <span class="math inline">\(X_0\)</span> é crítica para garantir que o LCG produza números pseudoaleatórios de alta qualidade e com um período longo.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-3-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-1" role="tab" aria-controls="tabset-3-1" aria-selected="true">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-2" role="tab" aria-controls="tabset-3-2" aria-selected="false">Python</a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-3-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-3-1-tab">
<div class="cell">
<details class="code-fold">
<summary>Mostrar código</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Carregando o pacote ggplot2</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Classe para o Gerador Congruente Linear</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>LinearCongruentialGenerator <span class="ot">&lt;-</span> <span class="fu">setRefClass</span>(</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>  <span class="st">"LinearCongruentialGenerator"</span>,</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">fields =</span> <span class="fu">list</span>(<span class="at">a =</span> <span class="st">"numeric"</span>, <span class="at">c =</span> <span class="st">"numeric"</span>, <span class="at">m =</span> <span class="st">"numeric"</span>, <span class="at">semente =</span> <span class="st">"numeric"</span>),</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">methods =</span> <span class="fu">list</span>(</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">initialize =</span> <span class="cf">function</span>(semente, <span class="at">a =</span> <span class="dv">1103515245</span>, <span class="at">c =</span> <span class="dv">12345</span>, <span class="at">m =</span> <span class="dv">2</span><span class="sc">^</span><span class="dv">32</span>) {</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>      .self<span class="sc">$</span>a <span class="ot">&lt;-</span> a</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>      .self<span class="sc">$</span>c <span class="ot">&lt;-</span> c</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>      .self<span class="sc">$</span>m <span class="ot">&lt;-</span> m</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>      .self<span class="sc">$</span>semente <span class="ot">&lt;-</span> semente</span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>    },</span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">gerar =</span> <span class="cf">function</span>() {</span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Atualizando a semente</span></span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>      .self<span class="sc">$</span>semente <span class="ot">&lt;-</span> (.self<span class="sc">$</span>a <span class="sc">*</span> .self<span class="sc">$</span>semente <span class="sc">+</span> .self<span class="sc">$</span>c) <span class="sc">%%</span> .self<span class="sc">$</span>m</span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>      <span class="fu">return</span>(.self<span class="sc">$</span>semente <span class="sc">/</span> .self<span class="sc">$</span>m)  <span class="co"># Normalizando para [0, 1)</span></span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Inicializando o gerador com uma semente</span></span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a>lcg <span class="ot">&lt;-</span> LinearCongruentialGenerator<span class="sc">$</span><span class="fu">new</span>(<span class="at">semente =</span> <span class="dv">5</span>)</span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Gerando 1000 números pseudoaleatórios</span></span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true" tabindex="-1"></a>numeros_gerados <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">100000</span>, <span class="cf">function</span>(x) lcg<span class="sc">$</span><span class="fu">gerar</span>())</span>
<span id="cb13-28"><a href="#cb13-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-29"><a href="#cb13-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Convertendo para um data.frame</span></span>
<span id="cb13-30"><a href="#cb13-30" aria-hidden="true" tabindex="-1"></a>dados <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">numeros_gerados =</span> numeros_gerados)</span>
<span id="cb13-31"><a href="#cb13-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-32"><a href="#cb13-32" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotando o histograma dos números gerados</span></span>
<span id="cb13-33"><a href="#cb13-33" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(dados, <span class="fu">aes</span>(<span class="at">x =</span> numeros_gerados)) <span class="sc">+</span></span>
<span id="cb13-34"><a href="#cb13-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">20</span>, <span class="at">fill =</span> <span class="st">'skyblue'</span>, <span class="at">color =</span> <span class="st">'black'</span>) <span class="sc">+</span></span>
<span id="cb13-35"><a href="#cb13-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">'Histograma dos Números Pseudoaleatórios Gerados pelo LCG'</span>) <span class="sc">+</span></span>
<span id="cb13-36"><a href="#cb13-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">'Valor'</span>) <span class="sc">+</span></span>
<span id="cb13-37"><a href="#cb13-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">'Frequência'</span>) <span class="sc">+</span></span>
<span id="cb13-38"><a href="#cb13-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb13-39"><a href="#cb13-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"grey"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="2_pseudorandom_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-3-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-2-tab">
<div class="cell">
<details class="code-fold">
<summary>Mostrar código</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> LinearCongruentialGenerator:</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, semente, a<span class="op">=</span><span class="dv">1103515245</span>, c<span class="op">=</span><span class="dv">12345</span>, m<span class="op">=</span><span class="dv">2</span><span class="op">**</span><span class="dv">32</span>):</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.a <span class="op">=</span> a</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.c <span class="op">=</span> c</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.m <span class="op">=</span> m</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.semente <span class="op">=</span> semente</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> gerar(<span class="va">self</span>):</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Atualizando a semente</span></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.semente <span class="op">=</span> (<span class="va">self</span>.a <span class="op">*</span> <span class="va">self</span>.semente <span class="op">+</span> <span class="va">self</span>.c) <span class="op">%</span> <span class="va">self</span>.m</span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">self</span>.semente <span class="op">/</span> <span class="va">self</span>.m  <span class="co"># Normalizando para [0, 1)</span></span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Inicializando o gerador com uma semente</span></span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>lcg <span class="op">=</span> LinearCongruentialGenerator(semente<span class="op">=</span><span class="dv">5</span>)</span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Gerando 1000 números pseudoaleatórios</span></span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a>numeros_gerados <span class="op">=</span> [lcg.gerar() <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">100000</span>)]</span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotando o histograma dos números gerados</span></span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a>plt.hist(numeros_gerados, bins<span class="op">=</span><span class="dv">20</span>, color<span class="op">=</span><span class="st">'skyblue'</span>, edgecolor<span class="op">=</span><span class="st">'black'</span>)</span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Histograma dos Números Pseudoaleatórios Gerados pelo LCG'</span>)</span>
<span id="cb14-25"><a href="#cb14-25" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Valor'</span>)</span>
<span id="cb14-26"><a href="#cb14-26" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Frequência'</span>)</span>
<span id="cb14-27"><a href="#cb14-27" aria-hidden="true" tabindex="-1"></a>plt.grid(<span class="va">True</span>)</span>
<span id="cb14-28"><a href="#cb14-28" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="2_pseudorandom_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="gerando-números-uniformes-com-uma-moeda" class="level2" data-number="4.4">
<h2 data-number="4.4" class="anchored" data-anchor-id="gerando-números-uniformes-com-uma-moeda"><span class="header-section-number">4.4</span> Gerando números uniformes com uma moeda</h2>
<p>Este código mostra como é possível gerar números uniformemente distribuídos no intervalo [0, 1] utilizando o lançamento de uma moeda justa. A ideia central baseia-se na expansão binária, onde cada lançamento da moeda representa um bit da representação binária do número. Ao somar <span class="math inline">\(2^{-(i+1))}\)</span> para cada bit, construímos o número em base 2, garantindo uma distribuição uniforme. Isso ocorre porque cada bit tem uma probabilidade igual de ser 0 ou 1, criando uma sequência que cobre uniformemente o intervalo desejado.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-4-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-1" role="tab" aria-controls="tabset-4-1" aria-selected="true">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-2" role="tab" aria-controls="tabset-4-2" aria-selected="false">Python</a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-4-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-4-1-tab">
<div class="cell">
<details class="code-fold">
<summary>Mostrar código</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Carregando pacotes necessários</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Função para simular o lançamento de uma moeda justa</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>lancar_moeda <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Lançar moeda justa: 0 para coroa (K) e 1 para cara (C)</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="dv">1</span>)</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Função para gerar um número uniformemente distribuído usando uma moeda</span></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>gerar_numero_uniforme <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">n_bits =</span> <span class="dv">32</span>) {</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>  numero <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_bits) {</span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>    bit <span class="ot">&lt;-</span> <span class="fu">lancar_moeda</span>()</span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Atualizando o número, multiplicando pela base 2</span></span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>    numero <span class="ot">&lt;-</span> numero <span class="sc">+</span> bit <span class="sc">*</span> (<span class="dv">2</span><span class="sc">^-</span>(i))</span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(numero)</span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Gerando 10000 números uniformemente distribuídos</span></span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a>numeros_uniformes <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10000</span>, <span class="cf">function</span>(x) <span class="fu">gerar_numero_uniforme</span>())</span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Convertendo para um data.frame</span></span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true" tabindex="-1"></a>dados <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">numeros_uniformes =</span> numeros_uniformes)</span>
<span id="cb15-26"><a href="#cb15-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-27"><a href="#cb15-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotando o histograma dos números gerados</span></span>
<span id="cb15-28"><a href="#cb15-28" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(dados, <span class="fu">aes</span>(<span class="at">x =</span> numeros_uniformes)) <span class="sc">+</span></span>
<span id="cb15-29"><a href="#cb15-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">20</span>, <span class="at">fill =</span> <span class="st">'skyblue'</span>, <span class="at">color =</span> <span class="st">'black'</span>) <span class="sc">+</span></span>
<span id="cb15-30"><a href="#cb15-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">'Histograma de Números Uniformes Gerados Usando uma Moeda Justa'</span>) <span class="sc">+</span></span>
<span id="cb15-31"><a href="#cb15-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">'Valor'</span>) <span class="sc">+</span></span>
<span id="cb15-32"><a href="#cb15-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">'Frequência'</span>) <span class="sc">+</span></span>
<span id="cb15-33"><a href="#cb15-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb15-34"><a href="#cb15-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"grey"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="2_pseudorandom_files/figure-html/unnamed-chunk-7-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-4-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-2-tab">
<div class="cell">
<details class="code-fold">
<summary>Mostrar código</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> random</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Função para simular o lançamento de uma moeda justa</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> lancar_moeda():</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Lançar moeda justa: 0 para coroa (K) e 1 para cara (C)</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> random.choice([<span class="dv">0</span>, <span class="dv">1</span>])</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Função para gerar um número uniformemente distribuído usando uma moeda</span></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> gerar_numero_uniforme(n_bits<span class="op">=</span><span class="dv">32</span>):</span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>    numero <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n_bits):</span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>        bit <span class="op">=</span> lancar_moeda()</span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Atualizando o número, multiplicando pela base 2</span></span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>        numero <span class="op">+=</span> bit <span class="op">*</span> (<span class="dv">2</span> <span class="op">**</span> <span class="op">-</span>(i <span class="op">+</span> <span class="dv">1</span>))  <span class="co"># Cada bit tem um peso de 2^-(posição)</span></span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> numero</span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Gerando 1000 números uniformemente distribuídos</span></span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a>numeros_uniformes <span class="op">=</span> [gerar_numero_uniforme() <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">10000</span>)]</span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotando o histograma dos números gerados</span></span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb16-23"><a href="#cb16-23" aria-hidden="true" tabindex="-1"></a>plt.hist(numeros_uniformes, bins<span class="op">=</span><span class="dv">20</span>, color<span class="op">=</span><span class="st">'skyblue'</span>, edgecolor<span class="op">=</span><span class="st">'black'</span>)</span>
<span id="cb16-24"><a href="#cb16-24" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Histograma de Números Uniformes Gerados Usando uma Moeda Justa'</span>)</span>
<span id="cb16-25"><a href="#cb16-25" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Valor'</span>)</span>
<span id="cb16-26"><a href="#cb16-26" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Frequência'</span>)</span>
<span id="cb16-27"><a href="#cb16-27" aria-hidden="true" tabindex="-1"></a>plt.grid(<span class="va">True</span>)</span>
<span id="cb16-28"><a href="#cb16-28" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="2_pseudorandom_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>


</section>
<section id="método-de-monte-carlo" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> Método de Monte Carlo</h1>
<p>Os <strong>Métodos de Monte Carlo</strong> (MMC) são uma técnica poderosa que utiliza a simulação de valores aleatórios para calcular aproximações de valores esperados e integrais que não podem ser resolvidos analiticamente. Neste contexto, aprendemos a utilizar variáveis aleatórias simuladas para realizar o cálculo aproximado de integrais.</p>
<p>Seja <span class="math inline">\(X\)</span> uma v.a. discreta com função de probabilidade <span class="math inline">\(p(x)\)</span> ou uma v.a. contínua com função densidade <span class="math inline">\(f(x)\)</span>. O Método de Monte Carlo propõe um estimador para <span class="math display">\[
\theta = \mathbb{E}[g(X)] = \begin{cases}
\int_{-\infty}^{\infty} g(x) f(x) \, dx &amp; \text{se $X$ é contínua} \\
\sum_x g(x) p(x) &amp; \text{se $X$ é discreta}
\end{cases}
\]</span></p>
<p>Especificamente, ele funciona da seguinte forma. Seja <span class="math inline">\(X_1, \dots, X_n\)</span> uma sequência de variáveis aleatórias i.i.d. com a mesma distribuição que <span class="math inline">\(X\)</span>. Então:</p>
<p><span class="math display">\[
\hat{\theta}_n = \frac{1}{n} \sum_{i=1}^n g(X_i)
\]</span></p>
<p>é o estimador de Monte Carlo para <span class="math inline">\(\theta\)</span>.</p>
<p><strong>Pseudo-Algoritmo para aproximar <span class="math inline">\(\theta\)</span>:</strong></p>
<ol type="1">
<li>Gere <span class="math inline">\(X_1, \dots, X_n\)</span> valores independentes da v.a. <span class="math inline">\(X\)</span>.</li>
<li>Calcule: <span class="math display">\[
\hat{\theta}_n = \frac{1}{n} \sum_{i=1}^n g(X_i)
\]</span></li>
</ol>
<p><strong>Porque Funciona?</strong></p>
<p>O método de Monte Carlo funciona devido à Lei Forte dos Grandes Números, que garante que a média amostral convergirá quase certamente para a esperança verdadeira conforme o número de amostras tende ao infinito:</p>
<p><span class="math display">\[
\hat{\theta}_n = \frac{1}{n} \sum_{i=1}^n g(X_i)    \longrightarrow    \theta \text{ (quase certamente)}
\]</span></p>
<p>Assim, quando <span class="math inline">\(n\)</span> cresce, a estimativa de Monte Carlo converge para o verdadeiro valor de <span class="math inline">\(\theta\)</span>.</p>
<p><strong>Importante</strong>: Frenquentemente <span class="math inline">\(n\)</span> é denotado por <span class="math inline">\(B\)</span> na literatura de Monte Carlo, de forma a não haver confusão com o tamanho de amostras não geradas no computador.</p>
<section id="exemplo-1-estimativa-de-uma-integral" class="level2" data-number="5.1">
<h2 data-number="5.1" class="anchored" data-anchor-id="exemplo-1-estimativa-de-uma-integral"><span class="header-section-number">5.1</span> Exemplo 1: Estimativa de uma Integral</h2>
<p>Queremos obter uma estimativa para</p>
<p><span class="math display">\[
\theta = \int\limits_{0}^{1}e^{-x} dx
\]</span></p>
<p>Para isso, basta observar que se <span class="math inline">\(U \sim Unif(0,1)\)</span>, então <span class="math inline">\(\theta = \mathbb{E}[e^{-U}]\)</span>. De fato, se <span class="math inline">\(U \in Unif(0,1)\)</span>, <span class="math display">\[
\theta=\int\limits_{0}^{1}e^{-x} dx= \int\limits_{0}^{1}e^{-u}f(u) du.
\]</span> Assim, o estimador desta integral via MMC pode ser obtido da seguinte forma:</p>
<div class="tabset-margin-container"></div><div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-5-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-1" role="tab" aria-controls="tabset-5-1" aria-selected="true">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-2" role="tab" aria-controls="tabset-5-2" aria-selected="false">Python</a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-5-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-5-1-tab">
<pre class="{r}"><code>n &lt;- 100
u &lt;- runif(n, min = 0, max = 1)

# Estimativa de theta usando Monte Carlo
theta_hat &lt;- mean(exp(-u))
cat("Estimativa de theta_hat:", theta_hat, "\n")

# Valor real da integral
valor_real &lt;- 1 - exp(-1)
cat("Valor real:", valor_real, "\n")</code></pre>
</div>
<div id="tabset-5-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-2-tab">
<pre class="{python}"><code>import numpy as np

# Número de amostras
n = 100

# Geração de amostras uniformes
u = np.random.uniform(0, 1, n)

# Estimativa de theta usando Monte Carlo
theta_hat = np.mean(np.exp(-u))
print("Estimativa de theta_hat:", theta_hat)

# Valor real da integral
valor_real = 1 - np.exp(-1)
print("Valor real:", valor_real)</code></pre>
</div>
</div>
</div>
<p>Vamos verificar como o valor de <span class="math inline">\(n\)</span> influencia na aproximação:</p>
<div class="tabset-margin-container"></div><div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-6-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-1" role="tab" aria-controls="tabset-6-1" aria-selected="true">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-2" role="tab" aria-controls="tabset-6-2" aria-selected="false">Python</a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-6-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-6-1-tab">
<pre class="{r}"><code>library(ggplot2)

set.seed(58)
N &lt;- 1:2000
theta_hat &lt;- numeric(length(N))
u &lt;- numeric(length(N))  # Pré-alocação do vetor

# Preenchendo o vetor u e calculando theta_hat
for (i in seq_along(N)) {
  u[i] &lt;- runif(1)
  theta_hat[i] &lt;- mean(exp(-u[1:i]))
}

# Criando o dataframe para o ggplot
df &lt;- data.frame(N = N, theta_hat = theta_hat)

# Plotar o gráfico usando ggplot2
ggplot(df, aes(x = N, y = theta_hat)) +
  geom_line(color = "blue") +
  geom_hline(yintercept = 1 - exp(-1), color = "red", linetype = "dashed") +
  labs(x = "n", y = expression(hat(theta)[n]), title = expression(Aproximação~de~theta)) +
  theme_minimal()</code></pre>
</div>
<div id="tabset-6-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-2-tab">
<pre class="{python}"><code>import numpy as np
import matplotlib.pyplot as plt

np.random.seed(58)
N = np.arange(1, 2001, 1)
theta_hat = np.zeros(len(N))
u = np.array([])

for i in range(len(N)):
    u = np.append(u, np.random.uniform(0, 1))
    theta_hat[i] = np.mean(np.exp(-u))

plt.plot(N, theta_hat)
plt.axhline(y=1 - np.exp(-1), color='red', linestyle='--')
plt.xlabel('n')
plt.ylabel(r'$\hat{\theta}_n$')
plt.title(r'Aproximação de $\theta$')
plt.show()</code></pre>
</div>
</div>
</div>
<p>Esse gráfico mostra a evolução da estimativa à medida que o número de variáveis aleatórias <span class="math inline">\(n\)</span> aumenta, comparando com o valor real da integral.</p>
</section>
<section id="exemplo-2-aproximando-uma-probabilidade" class="level2" data-number="5.2">
<h2 data-number="5.2" class="anchored" data-anchor-id="exemplo-2-aproximando-uma-probabilidade"><span class="header-section-number">5.2</span> Exemplo 2: Aproximando uma Probabilidade</h2>
<p>Seja <span class="math inline">\(X \sim Gama(2,3)\)</span>. Queremos aproximar o valor de <span class="math inline">\(\mathbb{P}(X \geq 0.4)\)</span> usando o método de Monte Carlo. Note que <span class="math display">\[\theta:= \mathbb{P}(X \geq 0.4) = \int g(x)f(x)dx,\]</span> em que <span class="math inline">\(g(x)=I(x \geq 0.4)\)</span> e <span class="math inline">\(f(x)\)</span> é a densidade da Gama(2,3). Assim, podemos aproximar a probabilidade gerada via MC.</p>
<p>Neste caso, o algoritmo corresponde a gerar <span class="math inline">\(X_i \sim Gama(2,3)\)</span>, defir e definir uma variável indicadora <span class="math inline">\(Y_i\)</span> que vale 1 quando <span class="math inline">\(X_i \geq 0.4\)</span> e 0 caso contrário. A estimativa de Monte Carlo é dada pela média dos <span class="math inline">\(Y_i\)</span>’s:</p>
<div class="tabset-margin-container"></div><div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-7-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-1" role="tab" aria-controls="tabset-7-1" aria-selected="true">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-2" role="tab" aria-controls="tabset-7-2" aria-selected="false">Python</a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-7-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-7-1-tab">
<pre class="{r}"><code>set.seed(58)
library(ggplot2)

# Número de amostras
N &lt;- 50000

# Geração de amostras da distribuição Gamma
x &lt;- rgamma(N, shape = 2, rate = 3)  # Usando rate = 1/scale

# Cálculo de P(X &gt;= 0.4)
y &lt;- as.integer(x &gt;= 0.4)

# Estimativa via Monte Carlo
valor_aproximado &lt;- mean(y)
cat("Valor aproximado via Monte Carlo:", valor_aproximado, "\n")

# Valor real usando a função de distribuição acumulada (CDF)
valor_real &lt;- 1 - pgamma(0.4, shape = 2, rate = 3)
cat("Valor real (CDF):", valor_real, "\n")</code></pre>
</div>
<div id="tabset-7-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-2-tab">
<pre class="{python}"><code>import numpy as np
from scipy.stats import gamma

# Número de amostras
N = 50000

# Geração de amostras da distribuição Gamma
x = gamma.rvs(2, scale=1/3, size=N)

# Cálculo de P(X &gt;= 0.4)
y = (x &gt;= 0.4).astype(int)

# Estimativa via Monte Carlo
valor_aproximado = np.mean(y)
print("Valor aproximado via Monte Carlo:", valor_aproximado)

# Valor real usando a função de distribuição acumulada (CDF)
valor_real = 1 - gamma.cdf(0.4, 2, scale=1/3)
print("Valor real (CDF):", valor_real)</code></pre>
</div>
</div>
</div>
</section>
<section id="exemplo-3-aproximando-o-valor-de-pi" class="level2" data-number="5.3">
<h2 data-number="5.3" class="anchored" data-anchor-id="exemplo-3-aproximando-o-valor-de-pi"><span class="header-section-number">5.3</span> Exemplo 3: Aproximando o valor de <span class="math inline">\(\pi\)</span></h2>
<p>Neste exemplo, queremos aproximar o valor de <span class="math inline">\(\pi\)</span> utilizando o método de Monte Carlo. A ideia é gerar pontos aleatórios em um quadrado e contar quantos caem dentro de um círculo inscrito no quadrado. Vamos seguir o raciocínio a partir da geometria básica.</p>
<section id="geometria" class="level4" data-number="5.3.0.1">
<h4 data-number="5.3.0.1" class="anchored" data-anchor-id="geometria"><span class="header-section-number">5.3.0.1</span> Geometria</h4>
<ul>
<li>Considere um quadrado com lado 2 centrado na origem, ou seja, o quadrado vai de <span class="math inline">\((-1, -1)\)</span> até <span class="math inline">\((1, 1)\)</span>.</li>
<li>Dentro deste quadrado, inscreva um círculo de raio 1, também centrado na origem.</li>
<li>A área do quadrado é <span class="math inline">\(4\)</span> (já que <span class="math inline">\(2 \times 2 = 4\)</span>) e a área do círculo é <span class="math inline">\(\pi \cdot r^2 = \pi \cdot 1^2 = \pi\)</span>.</li>
</ul>
<p>A razão entre a área do círculo e a área do quadrado é dada por:</p>
<p><span class="math display">\[
\frac{\text{Área do círculo}}{\text{Área do quadrado}} = \frac{\pi}{4}
\]</span></p>
<div class="tabset-margin-container"></div><div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-8-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-1" role="tab" aria-controls="tabset-8-1" aria-selected="true">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-8-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-2" role="tab" aria-controls="tabset-8-2" aria-selected="false">Python</a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-8-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-8-1-tab">
<pre class="{r}"><code>require(plotrix)
require(grid)

plot(c(-1, 1), c(-1,1), type = "n", asp=1,xlab="",yla="")
rect( -1, -1, 1, 1,border="blue") 
draw.circle( 0, 0, 1 ,border="red")</code></pre>
</div>
<div id="tabset-8-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-8-2-tab">
<pre class="{python}"><code>import matplotlib.pyplot as plt
from matplotlib.patches import Rectangle, Circle

# Configura o gráfico
fig, ax = plt.subplots()
ax.set_aspect('equal')  # Define o aspecto como 1:1 (quadrado)
ax.set_xlim(-1, 1)
ax.set_ylim(-1, 1)
ax.set_xlabel('')
ax.set_ylabel('')

# Desenha o retângulo
rect = Rectangle((-1, -1), 2, 2, edgecolor='blue', facecolor='none')
ax.add_patch(rect)

# Desenha o círculo
circle = Circle((0, 0), 1, edgecolor='red', facecolor='none')
ax.add_patch(circle)

# Mostra o gráfico
plt.show()</code></pre>
</div>
</div>
</div>
<p>Para estimar <span class="math inline">\(\pi\)</span> usando Monte Carlo, procedemos da seguinte forma:</p>
<ol type="1">
<li><p>Geramos pontos aleatórios <span class="math inline">\((x, y)\)</span> no quadrado <span class="math inline">\([-1, 1] \times [-1, 1]\)</span>.</p></li>
<li><p>Verificamos se cada ponto está dentro do círculo, o que ocorre se <span class="math inline">\(x^2 + y^2 \leq 1\)</span>.</p></li>
<li><p>A fração de pontos que caem dentro do círculo aproxima a razão <span class="math inline">\(\frac{\pi}{4}\)</span>.</p></li>
<li><p>Multiplicamos essa fração por 4 para obter uma estimativa de <span class="math inline">\(\pi\)</span>.</p></li>
</ol>
</section>
<section id="matemática-do-estimador" class="level4" data-number="5.3.0.2">
<h4 data-number="5.3.0.2" class="anchored" data-anchor-id="matemática-do-estimador"><span class="header-section-number">5.3.0.2</span> Matemática do Estimador</h4>
<p>Formalmente, se <span class="math inline">\((X,Y) \sim Unif(-1,1) \times Unif(-1,1)\)</span> e <span class="math inline">\(g(x,y)=I(\text{(x,y) está no círculo})\)</span>, temos que <span class="math display">\[\theta:=\int g(x,y)f(x,y) dxdy =  \frac{\text{Área do círculo}}{\text{Área do quadrado}} = \frac{\pi}{4} \]</span> Assim, se <span class="math inline">\((X_i,Y_i)\)</span> é um ponto gerado uniformemente dentro do quadrado, o estimador de Monte Carlo para <span class="math inline">\(\frac{\pi}{4}\)</span> é dado por: <span class="math display">\[
\hat{\theta}_n = \frac{1}{n} \sum_{i=1}^n g(x_i,y_i)= \frac{1}{n} \sum_{i=1}^n z_i,
\]</span> em que <span class="math inline">\(z_i = 1\)</span> se o ponto <span class="math inline">\(i\)</span> está dentro do círculo (i.e., se <span class="math inline">\(x_i^2 + y_i^2 \leq 1\)</span>) e <span class="math inline">\(z_i = 0\)</span> caso contrário.</p>
<p>Multiplicando por 4, obtemos a estimativa de <span class="math inline">\(\pi\)</span>:</p>
<p><span class="math display">\[
\hat{\pi}_n = 4 \cdot \hat{\theta}_n = 4 \cdot \frac{1}{n} \sum_{i=1}^n z_i
\]</span></p>
<p>De acordo com a <strong>Lei Forte dos Grandes Números</strong>, sabemos que:</p>
<p><span class="math display">\[
\hat{\pi}_n \longrightarrow \pi \quad \text{(quase certamente, quando $n \to \infty$)}.
\]</span></p>
<p>Ou seja, à medida que o número de pontos simulados <span class="math inline">\(n\)</span> aumenta, a estimativa <span class="math inline">\(\hat{\pi}_n\)</span> convergirá para o valor verdadeiro de <span class="math inline">\(\pi\)</span>.</p>
<p><strong>Implementação</strong></p>
<p>Os trechos de código fornecidos em R e Python simulam esse processo, gerando <span class="math inline">\(n\)</span> pontos e calculando a aproximação de <span class="math inline">\(\pi\)</span> com base nos pontos que caem dentro do círculo. Além disso, são gerados gráficos que mostram como a estimativa de <span class="math inline">\(\pi\)</span> melhora conforme o número de simulações aumenta, evidenciando a convergência mencionada.</p>
<p>Agora que todos os detalhes matemáticos do exemplo estão claros, o código para simulação pode ser executado para observar a aproximação prática de <span class="math inline">\(\pi\)</span>.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-9-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-1" role="tab" aria-controls="tabset-9-1" aria-selected="true">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-9-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-2" role="tab" aria-controls="tabset-9-2" aria-selected="false">Python</a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-9-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-9-1-tab">
<pre class="{r}"><code>set.seed(459)
library(ggplot2)

N &lt;- 1:80000
z &lt;- numeric(length(N))

# Loop para gerar os pontos e verificar se estão dentro do círculo
for (i in seq_along(N)) {
  x &lt;- 2 * runif(1) - 1
  y &lt;- 2 * runif(1) - 1
  z[i] &lt;- (x^2 + y^2 &lt;= 1)
}

# Cálculo da estimativa de pi
theta_hat &lt;- cumsum(z) / N
pi_hat &lt;- theta_hat * 4

# Criando o dataframe para o ggplot
df &lt;- data.frame(N = N, pi_hat = pi_hat)

# Plotar o gráfico usando ggplot2
ggplot(df, aes(x = N, y = pi_hat)) +
  geom_line(color = "blue") +
  geom_hline(yintercept = pi, color = "red", linetype = "dashed") +
  labs(x = "n", y = expression(hat(pi)[n]), title = expression(Aproximacao~de~pi)) +
  theme_minimal()</code></pre>
</div>
<div id="tabset-9-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-9-2-tab">
<pre class="{python}"><code>import numpy as np
import matplotlib.pyplot as plt

np.random.seed(459)
N = np.arange(1, 80001, 1)
z = np.zeros(len(N))

for i in range(len(N)):
    x = 2 * np.random.uniform(0, 1) - 1
    y = 2 * np.random.uniform(0, 1) - 1
    z[i] = (x**2 + y**2 &lt;= 1)

theta_hat = np.cumsum(z) / N
pi_hat = theta_hat * 4

plt.plot(N, pi_hat)
plt.axhline(y=np.pi, color='red', linestyle='--')
plt.xlabel('n')
plt.ylabel(r'$\hat{\pi}_n$')
plt.title(r'Aproximação de $\pi$')
plt.show()</code></pre>
</div>
</div>
</div>
<p>Esse gráfico mostra como a estimativa de <span class="math inline">\(\pi\)</span> melhora conforme o número de pontos simulados <span class="math inline">\(n\)</span> aumenta.</p>
</section>
</section>
<section id="intervalos-de-confiança-para-estimativas-de-monte-carlo" class="level2" data-number="5.4">
<h2 data-number="5.4" class="anchored" data-anchor-id="intervalos-de-confiança-para-estimativas-de-monte-carlo"><span class="header-section-number">5.4</span> Intervalos de Confiança para Estimativas de Monte Carlo</h2>
<p>O Método de Monte Carlo possibilita quantificar a incerteza em nossas estimativas. Para isso, podemos utilizar <strong>intervalos de confiança</strong>.</p>
<p>Suponha que temos uma sequência de amostras <span class="math inline">\(X_1, X_2, \dots, X_n\)</span> de uma variável aleatória <span class="math inline">\(X\)</span>, e calculamos a média amostral <span class="math inline">\(\hat{\theta}_n = \frac{1}{n} \sum_{i=1}^n g(X_i)\)</span>. Pelo <strong>Teorema Central do Limite</strong>, sabemos que, para <span class="math inline">\(n\)</span> suficientemente grande, a média amostral <span class="math inline">\(\hat{\theta}_n\)</span> é aproximadamente normalmente distribuída:</p>
<p><span class="math display">\[
\hat{\theta}_n \sim N\left( \theta, \frac{\sigma^2}{n} \right)
\]</span></p>
<p>onde <span class="math inline">\(\sigma^2 = \text{Var}[g(X)]\)</span> é a variância de <span class="math inline">\(g(X)\)</span>. Essa aproximação permite a construção de um intervalo de confiança para <span class="math inline">\(\theta\)</span>.</p>
<p>O intervalo de confiança aproximado para <span class="math inline">\(\theta\)</span> com nível de confiança <span class="math inline">\((1 - \alpha) \times 100\%\)</span> é dado por:</p>
<p><span class="math display">\[
\hat{\theta}_n \pm z_{\alpha/2} \frac{\hat{\sigma}}{\sqrt{n}}
\]</span></p>
<p>onde <span class="math inline">\(z_{\alpha/2}\)</span> é o quantil da distribuição normal padrão associado à probabilidade <span class="math inline">\(\alpha/2\)</span> e <span class="math inline">\(\hat{\sigma}\)</span> é a estimativa da variância de <span class="math inline">\(g(X)\)</span>, obtida a partir das amostras.</p>
<p><strong>Pseudo-Algoritmo para construir um intervalo de confiança:</strong></p>
<ol type="1">
<li>Gere <span class="math inline">\(X_1, \dots, X_n\)</span> amostras i.i.d. da v.a. <span class="math inline">\(X\)</span>.</li>
<li>Calcule <span class="math inline">\(\hat{\theta}_n = \frac{1}{n} \sum_{i=1}^n g(X_i)\)</span>.</li>
<li>Estime a variância de <span class="math inline">\(g(X)\)</span> como: <span class="math display">\[
\hat{\sigma}^2 = \frac{1}{n} \sum_{i=1}^n (g(X_i) - \hat{\theta}_n)^2
\]</span></li>
<li>Calcule o intervalo de confiança: <span class="math display">\[
\hat{\theta}_n \pm z_{\alpha/2} \frac{\hat{\sigma}}{\sqrt{n}}
\]</span></li>
</ol>
<section id="exemplo-intervalo-de-confiança-para-a-estimativa-de-pi" class="level3" data-number="5.4.1">
<h3 data-number="5.4.1" class="anchored" data-anchor-id="exemplo-intervalo-de-confiança-para-a-estimativa-de-pi"><span class="header-section-number">5.4.1</span> Exemplo: Intervalo de Confiança para a Estimativa de <span class="math inline">\(\pi\)</span></h3>
<p>Neste exemplo, construímos um intervalo de confiança para a estimativa de <span class="math inline">\(\pi\)</span> usando o método de Monte Carlo, seguindo os passos acima.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-10-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-1" role="tab" aria-controls="tabset-10-1" aria-selected="true">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-10-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-2" role="tab" aria-controls="tabset-10-2" aria-selected="false">Python</a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-10-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-10-1-tab">
<pre class="{r}"><code>set.seed(0)
N &lt;- 10000  # número de amostras
z &lt;- numeric(N)

# Loop para gerar os pontos e verificar se estão dentro do círculo
for (i in 1:N) {
  x &lt;- 2 * runif(1) - 1
  y &lt;- 2 * runif(1) - 1
  z[i] &lt;- (x^2 + y^2 &lt;= 1)
}

# Estimativa de pi
theta_hat &lt;- mean(z)
pi_hat &lt;- theta_hat * 4
cat("Estimativa de pi:", pi_hat, "\n")

# Cálculo da variância e intervalo de confiança
sigma_hat &lt;- sqrt(var(z) / N)
alpha &lt;- 0.05  # Nível de significância
z_alpha2 &lt;- qnorm(1 - alpha / 2)

# Intervalo de confiança
IC &lt;- c(theta_hat - z_alpha2 * sigma_hat, theta_hat + z_alpha2 * sigma_hat) * 4
cat("Intervalo de confiança para pi:", IC, "\n")</code></pre>
</div>
<div id="tabset-10-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-10-2-tab">
<pre class="{python}"><code>import numpy as np
from scipy.stats import norm

# Semente para reprodução
np.random.seed(0)
N = 10000  # número de amostras
z = np.zeros(N)

# Loop para gerar os pontos e verificar se estão dentro do círculo
for i in range(N):
    x = 2 * np.random.uniform(0, 1) - 1
    y = 2 * np.random.uniform(0, 1) - 1
    z[i] = (x**2 + y**2 &lt;= 1)

# Estimativa de pi
theta_hat = np.mean(z)
pi_hat = theta_hat * 4
print("Estimativa de pi:", pi_hat)

# Cálculo da variância e intervalo de confiança
sigma_hat = np.sqrt(np.var(z) / N)
alpha = 0.05  # Nível de significância
z_alpha2 = norm.ppf(1 - alpha / 2)

# Intervalo de confiança
IC = (theta_hat - z_alpha2 * sigma_hat, theta_hat + z_alpha2 * sigma_hat)
IC = [i * 4 for i in IC]

print("Intervalo de confiança para pi:", IC)</code></pre>
</div>
</div>
</div>
<p>Neste caso, o intervalo de confiança construído em torno da estimativa <span class="math inline">\(\hat{\pi}_n\)</span> oferece uma ideia de quão próxima nossa estimativa está do valor verdadeiro de <span class="math inline">\(\pi\)</span>, com uma certa confiança.</p>
</section>
</section>
<section id="exemplo-4-problema-das-figurinhas" class="level2" data-number="5.5">
<h2 data-number="5.5" class="anchored" data-anchor-id="exemplo-4-problema-das-figurinhas"><span class="header-section-number">5.5</span> Exemplo 4: Problema das Figurinhas</h2>
<p>Um colecionador está juntando figurinhas para completar um álbum da Copa. Qual é a probabilidade de que, ao comprar <span class="math inline">\(n\)</span> pacotes, pelo menos um deles contenha duas ou mais figurinhas iguais? Durante o curso de probabilidade, você aprenderá como calcular essa probabilidade. Outra abordagem possível é o uso do método de Monte Carlo. Nesse caso, simulamos a compra de <span class="math inline">\(n\)</span> pacotes, cada um com 5 figurinhas, de um total de 640 figurinhas disponíveis no álbum. Repetimos essa simulação <span class="math inline">\(B=1000\)</span> vezes e contamos quantas vezes ocorreu pelo menos uma repetição de figurinhas em algum dos pacotes. A proporção de simulações com repetições é a estimativa de Monte Carlo da probabilidade que estamos interessados em calcular.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-11-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-11-1" role="tab" aria-controls="tabset-11-1" aria-selected="true">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-11-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-11-2" role="tab" aria-controls="tabset-11-2" aria-selected="false">Python</a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-11-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-11-1-tab">
<pre class="{r}"><code>nFigurinhas &lt;- 640
B &lt;- 1000
nPacotes &lt;- 1:50
aoMenosUmaRepetidaNoMesmoPacote &lt;- matrix(NA, length(nPacotes), B)
for(ii in 1:length(nPacotes)) {
  for(jj in 1:B) {
    figurinhas &lt;- sample(1:nFigurinhas, nPacotes[ii] * 5, replace = TRUE)
    figurinhas &lt;- matrix(figurinhas, nPacotes[ii], 5)
    aoMenosUmaRepetidaNoMesmoPacote[ii,jj] &lt;- sum(apply(figurinhas, 1, function(xx) length(unique(xx)) != length(xx)) &gt; 0)
  }
}

probCoincidencia &lt;- apply(aoMenosUmaRepetidaNoMesmoPacote, 1, mean)</code></pre>
</div>
<div id="tabset-11-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-11-2-tab">
<pre class="{python}"><code>import numpy as np
import random

nFigurinhas = 640
B = 1000
nPacotes = np.arange(1, 51)  # Intervalo de 1 a 50 (Python é exclusivo no final)
aoMenosUmaRepetidaNoMesmoPacote = np.empty((len(nPacotes), B))

for ii in range(len(nPacotes)):
    for jj in range(B):
        figurinhas = [random.choices(range(1, nFigurinhas + 1), k=5) for _ in range(nPacotes[ii])]
        figurinhas = np.array(figurinhas)
        aoMenosUmaRepetidaNoMesmoPacote[ii, jj] = np.sum([len(set(pacote)) != len(pacote) for pacote in figurinhas])

probCoincidencia = np.mean(aoMenosUmaRepetidaNoMesmoPacote, axis=1)</code></pre>
</div>
</div>
</div>
<p>Agora podemos visualizar os resultados obtidos por meio do gráfico a seguir:</p>
<div class="tabset-margin-container"></div><div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-12-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-12-1" role="tab" aria-controls="tabset-12-1" aria-selected="true">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-12-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-12-2" role="tab" aria-controls="tabset-12-2" aria-selected="false">Python</a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-12-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-12-1-tab">
<pre class="{r}"><code>dados &lt;- data.frame(probCoincidencia = probCoincidencia, nPacotes = nPacotes)

library(ggplot2)
ggplot(dados, aes(x = nPacotes, y = probCoincidencia)) +
  geom_point(aes(size = 1.1)) +
  xlab("Número de Pacotes") +
  ylab("Prob de ao menos 1 repetida no mesmo pacote") + 
  theme(legend.position = "none")+
  theme_minimal()</code></pre>
</div>
<div id="tabset-12-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-12-2-tab">
<pre class="{python}"><code>import pandas as pd
import matplotlib.pyplot as plt

# Criação do DataFrame
dados = pd.DataFrame({'nPacotes': nPacotes, 'probCoincidencia': probCoincidencia})

# Criação do gráfico
plt.figure(figsize=(8, 6))
plt.scatter(dados['nPacotes'], dados['probCoincidencia'], s=70)  # 's' ajusta o tamanho dos pontos
plt.xlabel('Número de Pacotes')
plt.ylabel('Prob de ao menos 1 repetida no mesmo pacote')
plt.grid(True, which='both', linestyle='--', linewidth=0.7)
plt.gca().set_facecolor('white')  # Para seguir o tema minimalista
plt.show()</code></pre>
</div>
</div>
</div>
<p><strong>Simulação para completar o álbum</strong></p>
<p>Uma segunda pergunta que também podemos responder via simulação é: quantos pacotes necessitamos em média para completar o álbum? A solução estimada pode ser obtida com o código abaixo:</p>
<div class="tabset-margin-container"></div><div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-13-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-13-1" role="tab" aria-controls="tabset-13-1" aria-selected="true">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-13-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-13-2" role="tab" aria-controls="tabset-13-2" aria-selected="false">Python</a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-13-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-13-1-tab">
<pre class="{r}"><code>numeroPacotes &lt;- rep(NA, B)
for(jj in 1:B) {
  albumCompleto &lt;- FALSE
  nPacotes &lt;- 0
  figurinhas &lt;- NULL
  while(!albumCompleto) {
    figurinhas &lt;- c(figurinhas, sample(1:nFigurinhas, 5, replace = TRUE))
    if(length(unique(figurinhas)) == nFigurinhas) {
      albumCompleto &lt;- TRUE
    }
    nPacotes &lt;- nPacotes + 1
  }
  numeroPacotes[jj] &lt;- nPacotes
}</code></pre>
</div>
<div id="tabset-13-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-13-2-tab">
<pre class="{python}"><code>import numpy as np
import random

nFigurinhas = 640
B = 1000
numeroPacotes = np.empty(B)

for jj in range(B):
    albumCompleto = False
    nPacotes = 0
    figurinhas = []

    while not albumCompleto:
        figurinhas.extend(random.choices(range(1, nFigurinhas + 1), k=5))
        if len(set(figurinhas)) == nFigurinhas:
            albumCompleto = True
        nPacotes += 1

    numeroPacotes[jj] = nPacotes</code></pre>
</div>
</div>
</div>
<p>O número médio de pacotes necessários para completar o álbum é:</p>
<div class="tabset-margin-container"></div><div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-14-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-14-1" role="tab" aria-controls="tabset-14-1" aria-selected="true">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-14-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-14-2" role="tab" aria-controls="tabset-14-2" aria-selected="false">Python</a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-14-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-14-1-tab">
<pre class="{r}"><code>mean(numeroPacotes)</code></pre>
</div>
<div id="tabset-14-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-14-2-tab">
<pre class="{python}"><code>mean_numeroPacotes = np.mean(numeroPacotes)
mean_numeroPacotes</code></pre>
</div>
</div>
</div>
<p>Com essa simulação, também podemos estimar as seguintes probabilidades:</p>
<div class="tabset-margin-container"></div><div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-15-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-15-1" role="tab" aria-controls="tabset-15-1" aria-selected="true">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-15-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-15-2" role="tab" aria-controls="tabset-15-2" aria-selected="false">Python</a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-15-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-15-1-tab">
<pre class="{r}"><code>cat("Probabilidade de precisar de mais de 800 pacotes: ", mean(numeroPacotes &gt; 800) * 100, "%", sep = "")
cat("Probabilidade de precisar de mais de 1000 pacotes: ", mean(numeroPacotes &gt; 1000) * 100, "%", sep = "")</code></pre>
</div>
<div id="tabset-15-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-15-2-tab">
<pre class="{python}"><code>prob_mais_800 = np.mean(numeroPacotes &gt; 800) * 100
prob_mais_1000 = np.mean(numeroPacotes &gt; 1000) * 100

print(f"Probabilidade de precisar de mais de 800 pacotes: {prob_mais_800}%")
print(f"Probabilidade de precisar de mais de 1000 pacotes: {prob_mais_1000}%")</code></pre>
</div>
</div>
</div>
</section>
<section id="exercícios" class="level2" data-number="5.6">
<h2 data-number="5.6" class="anchored" data-anchor-id="exercícios"><span class="header-section-number">5.6</span> Exercícios</h2>
<p><span style="color:#2C92B2;"><strong>Exercício 1</strong></span>.</p>
<p>Utilize o método de Monte Carlo para aproximar a integral <span class="math display">\[
I = \int_0^{10} \sin(x^2) \, dx
\]</span></p>
<p>Forneça um intervalo de confiança para avaliar a precisão da estimativa.</p>
<p><span style="color:#2C92B2;"><strong>Exercício 2</strong></span>.</p>
<p>Utilize o método de Monte Carlo para aproximar a integral <span class="math display">\[
I = \int_1^{\infty} \frac{1}{x^3} \, dx
\]</span></p>
<p>Forneça um intervalo de confiança para avaliar a precisão da estimativa.</p>
<p><span style="color:#2C92B2;"><strong>Exercício 3</strong></span>.</p>
<p>Seja <span class="math inline">\(X \sim \text{Exp}(\lambda)\)</span> com <span class="math inline">\(\lambda = 2\)</span>. Estime a esperança <span class="math inline">\(\mathbb{E}[X^2]\)</span> utilizando o método de Monte Carlo. Forneça um intervalo de confiança para avaliar a precisão da estimativa. Compare com o valor real dessa quantidade.</p>
<p><span style="color:#2C92B2;"><strong>Exercício 4</strong></span>.</p>
<p>Considere que <span class="math inline">\(X\)</span> tem distribuição Normal(0,1) e <span class="math inline">\(Y\)</span> tem distribuição Gamma(1,1). Estime <span class="math inline">\(P(X\times Y &gt; 3)\)</span>. Forneça um intervalo de confiança para avaliar a precisão da estimativa.</p>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./1_intro.html" class="pagination-link" aria-label="Geração de Números Aleatórios e Aplicação em Estatística">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Geração de Números Aleatórios e Aplicação em Estatística</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./3_discrete_inversion.html" class="pagination-link" aria-label="Técnica da Inversão para Variáveis  Discretas">
        <span class="nav-page-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Técnica da Inversão para Variáveis Discretas</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>